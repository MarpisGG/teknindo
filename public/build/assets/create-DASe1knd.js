import{r as l,a as h,j as e,$ as N,S as u}from"./app-BBpXaxM-.js";import{S as p}from"./sweetalert2.esm.all-BQIkj5Wb.js";const w=()=>{const[b,g]=l.useState([]),[n,i]=l.useState({id:0,name:"",permissions:[]}),[m,d]=l.useState({}),[c,x]=l.useState(!1);l.useEffect(()=>{h.get("/api/permissions").then(r=>{const a=r.data.map(s=>({id:s.id,name:s.name,checked:!1}));g(a),i(s=>({...s,permissions:a}))})},[]);const f=(r,a)=>{const s=n.permissions.map((t,o)=>o===r?{...t,checked:a}:t);i(t=>({...t,permissions:s}))},j=r=>{r.preventDefault(),x(!0);const a={name:n.name,permissions:n.permissions.filter(s=>s.checked).map(s=>s.name)};h.post("/roles",a).then(()=>{p.fire("Success","Role created successfully.","success"),i({id:0,name:"",permissions:b.map(s=>({...s,checked:!1}))}),u.get("/admin/roles"),d({})}).catch(s=>{var t,o;d(((o=(t=s.response)==null?void 0:t.data)==null?void 0:o.errors)||{}),p.fire("Error","There was an error creating the role.","error")}).finally(()=>x(!1))},y=()=>{u.get("/admin/roles")};return e.jsx(e.Fragment,{children:e.jsx("div",{className:"min-h-screen bg-gray-100 py-10 px-4 flex justify-center",children:e.jsxs("div",{className:"w-full max-w-2xl bg-white shadow rounded-lg p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Create Role"}),e.jsx(N,{href:"/admin/roles",className:"text-blue-600 hover:underline",children:"← Back to Roles"})]}),e.jsxs("form",{onSubmit:j,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"Role Name"}),e.jsx("input",{type:"text",id:"name",value:n.name,onChange:r=>i(a=>({...a,name:r.target.value})),className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",required:!0}),m.name&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:m.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Permissions"}),e.jsx("div",{className:"grid grid-cols-2 gap-2 max-h-64 overflow-y-auto border rounded p-3",children:n.permissions.map((r,a)=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:`perm-${a}`,checked:r.checked,onChange:s=>f(a,s.target.checked),className:"mr-2"}),e.jsx("label",{htmlFor:`perm-${a}`,className:"text-sm text-gray-700",children:r.name})]},a))}),m.permissions&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:m.permissions})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{type:"button",onClick:y,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:c,className:`px-4 py-2 rounded-md text-white ${c?"bg-blue-400":"bg-blue-600 hover:bg-blue-700"}`,children:c?"Creating...":"Create Role"})]})]})]})})})};export{w as default};
