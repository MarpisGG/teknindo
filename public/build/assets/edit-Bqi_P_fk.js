import{K as U,r as u,j as e,S as N,a as E}from"./app-Cv0kKyuS.js";import{R as F}from"./index-C7p5L6mP.js";import{S as w}from"./sweetalert2.esm.all-BQIkj5Wb.js";const T=()=>{const{categories:l,types:d,products:r}=U().props,[t,n]=u.useState({name:r.name||"",description:r.description||"",specifications:r.specifications||"",brochure:null,image:null,poster:null,category_id:r.category_id||0,type_id:r.type_id||0,order:r.order||0}),[a,p]=u.useState({}),[g,j]=u.useState(!1),[y,x]=u.useState(null),[v,b]=u.useState(null);u.useEffect(()=>{r.image&&x(`/storage/${r.image}`),r.poster&&b(`/storage/${r.poster}`)},[r.image,r.poster]);const m=i=>{const{name:s,value:o}=i.target;n(c=>({...c,[s]:o}))},f=i=>{const{name:s,files:o}=i.target;if(o&&o.length>0){const c=o[0];n(h=>({...h,[s]:c})),s==="image"&&x(URL.createObjectURL(c)),s==="poster"&&b(URL.createObjectURL(c))}},_=i=>{i.preventDefault();const s=i.dataTransfer.files[0];s&&s.type.startsWith("image/")&&(n(o=>({...o,image:s})),x(URL.createObjectURL(s)))},k=()=>{n(i=>({...i,image:null})),x(null)},D=()=>{n(i=>({...i,poster:null})),b(null)},R=async i=>{var o,c;i.preventDefault(),j(!0),p({});const s=new FormData;s.append("name",t.name),s.append("description",t.description),s.append("specifications",t.specifications),s.append("category_id",t.category_id.toString()),s.append("type_id",t.type_id.toString()),t.brochure&&s.append("brochure",t.brochure),t.image&&s.append("image",t.image),t.poster&&s.append("poster",t.poster),s.append("order",t.order.toString()),s.append("_method","PUT");try{await E.post(`/products/${r.id}`,s),w.fire("Success","Product updated successfully","success"),N.get("/admin/products")}catch(h){(c=(o=h.response)==null?void 0:o.data)!=null&&c.errors?p(h.response.data.errors):w.fire("Error","Something went wrong","error")}finally{j(!1)}};return e.jsxs("div",{className:"mx-auto max-w-3xl px-4 py-8",children:[e.jsx("h1",{className:"mb-8 text-3xl font-semibold",children:"Edit Product"}),e.jsxs("form",{onSubmit:R,className:"space-y-6",children:[e.jsx(S,{label:"Name",name:"name",value:t.name,onChange:m,error:a.name}),e.jsx(C,{label:"Description",name:"description",value:t.description,onChange:m,error:a.description}),e.jsx(C,{label:"Specifications (JSON)",name:"specifications",value:t.specifications,onChange:m,error:a.specifications}),e.jsx(P,{label:"Category",name:"category_id",value:t.category_id,onChange:m,options:l,error:a.category_id}),e.jsx(P,{label:"Type",name:"type_id",value:t.type_id,onChange:m,options:d,error:a.type_id}),e.jsxs("div",{children:[e.jsx("label",{className:"block font-medium",children:"Brochure (PDF)"}),e.jsx("input",{type:"file",name:"brochure",accept:".pdf",onChange:f,className:"w-full rounded border px-4 py-2"}),a.brochure&&e.jsx("div",{className:"text-sm text-red-600",children:a.brochure})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block font-medium",children:"Image"}),e.jsxs("div",{onDragOver:i=>i.preventDefault(),onDrop:_,className:"cursor-pointer rounded border-2 border-dashed bg-gray-50 p-6 text-center transition hover:bg-gray-100",onClick:()=>{const i=document.getElementById("image-input");i&&i.click()},style:{position:"relative"},children:[e.jsx("p",{className:"text-gray-500",children:"Drag & drop image here or click to choose file"}),e.jsx("input",{id:"image-input",type:"file",accept:"image/*",onChange:f,name:"image",className:"hidden",tabIndex:-1}),y&&e.jsxs("div",{className:"relative mx-auto mt-4 w-fit",children:[e.jsx("img",{src:y,alt:"Preview",className:"h-24 rounded border shadow"}),e.jsx("button",{type:"button",onClick:k,className:"absolute top-0 right-0 rounded-full bg-red-500 px-2 text-xs text-white",children:"✕"})]})]}),a.image&&e.jsx("div",{className:"text-sm text-red-600",children:a.image})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block font-medium",children:"Poster (optional)"}),e.jsx("input",{type:"file",name:"poster",accept:"image/*",onChange:f,className:"w-full rounded border px-4 py-2"}),v&&e.jsxs("div",{className:"relative mx-auto mt-4 w-fit",children:[e.jsx("img",{src:v,alt:"Poster Preview",className:"h-24 rounded border shadow"}),e.jsx("button",{type:"button",onClick:D,className:"absolute top-0 right-0 rounded-full bg-red-500 px-2 text-xs text-white",children:"✕"})]}),a.poster&&e.jsx("div",{className:"text-sm text-red-600",children:a.poster})]}),e.jsx(S,{label:"Order",name:"order",type:"number",value:t.order,onChange:m,error:a.order}),e.jsxs("div",{className:"flex justify-start space-x-3 pt-4",children:[e.jsx("button",{type:"submit",disabled:g,className:`px-4 py-2 ${g?"bg-blue-300":"bg-blue-600 hover:bg-blue-700"} rounded-md text-white`,children:g?"Updating...":"Update Product"}),e.jsx("button",{type:"button",onClick:()=>N.get("/admin/products"),className:"rounded-md bg-gray-300 px-4 py-2 text-black",children:"Cancel"})]})]})]})},S=({label:l,name:d,type:r="text",value:t,onChange:n,error:a})=>e.jsxs("div",{children:[e.jsx("label",{className:"block font-medium",children:l}),e.jsx("input",{type:r,name:d,value:t,onChange:n,className:"w-full rounded border px-4 py-2"}),a&&e.jsx("div",{className:"text-sm text-red-600",children:a})]}),C=({label:l,name:d,value:r,onChange:t,error:n})=>e.jsxs("div",{children:[e.jsx("label",{className:"block font-medium",children:l}),e.jsx(F,{theme:"snow",value:r,onChange:a=>t({target:{name:d,value:a}}),className:"bg-white"}),n&&e.jsx("div",{className:"text-sm text-red-600",children:n})]}),P=({label:l,name:d,value:r,onChange:t,options:n,error:a})=>e.jsxs("div",{children:[e.jsx("label",{className:"block font-medium",children:l}),e.jsxs("select",{name:d,value:r,onChange:t,className:"w-full rounded border px-4 py-2",children:[e.jsxs("option",{value:"",children:["-- Select ",l," --"]}),n.map(p=>e.jsx("option",{value:p.id,children:p.name},p.id))]}),a&&e.jsx("div",{className:"text-sm text-red-600",children:a})]});export{T as default};
