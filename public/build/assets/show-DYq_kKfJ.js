import{r as l,K as w,j as e,$ as p,a as i}from"./app-CJho9Cej.js";import{S as a}from"./sweetalert2.esm.all-BQIkj5Wb.js";import{S as v,T as S}from"./trash-2-mdNfOux9.js";import"./createLucideIcon-B9xLQAxJ.js";const E=()=>{var h;const[t,g]=l.useState(null),[d,m]=l.useState([]),[b,o]=l.useState(!0),[x,c]=l.useState(null),{slug:n}=w().props,j=async()=>{if(!n){c("No blog identifier found"),o(!1);return}try{o(!0),c(null);const s=await i.get(`/api/blogs/${n}`),r=await i.get(`/api/blogs/${n}/comments`);g(s.data),m(Array.isArray(r.data)?r.data:r.data.data??[])}catch(s){console.error("Failed to load blog:",s),c("Failed to load blog details"),a.fire("Error","Failed to load blog details.","error")}finally{o(!1)}};l.useEffect(()=>{j()},[n]);const f=async()=>{if(!t)return;if((await a.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, delete it!"})).isConfirmed)try{await i.delete(`/blogs/${t.id}`),a.fire("Deleted!","Your blog has been deleted.","success"),window.location.href="/admin/blogs"}catch(r){console.error("Delete error:",r),a.fire("Error!","There was an error deleting the blog.","error")}},y=async s=>{if((await a.fire({title:"Delete Comment?",text:"This comment will be permanently removed.",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete it!"})).isConfirmed)try{await i.delete(`/comments/${s}`),m(u=>u.filter(N=>N.id!==s)),a.fire("Deleted!","Comment deleted successfully.","success")}catch{a.fire("Error!","Failed to delete comment.","error")}};return b?e.jsx("div",{className:"flex min-h-screen items-center justify-center bg-gray-50",children:e.jsx("div",{className:"animate-pulse text-xl text-gray-600",children:"Loading blog..."})}):x?e.jsx("div",{className:"flex min-h-screen items-center justify-center bg-red-50",children:e.jsx("div",{className:"text-xl text-red-700",children:x})}):t?e.jsx("div",{className:"blog container mx-auto px-4 py-10",children:e.jsxs("div",{className:"mx-auto max-w-6xl",children:[e.jsx(p,{href:"/admin/blogs",className:"mb-6 inline-flex items-center text-sm text-blue-600 hover:underline",children:"â† Back to Blogs"}),e.jsxs("article",{className:"overflow-hidden rounded-2xl bg-white shadow-lg",children:[t.thumbnail&&e.jsx("img",{src:`${t.thumbnail}`,alt:t.title,className:"max-h-64 w-full bg-gray-100 object-contain",style:{display:"block",margin:"0 auto"}}),e.jsxs("div",{className:"p-8",children:[e.jsx("h1",{className:"mb-4 text-4xl font-extrabold text-gray-900",children:t.title}),e.jsxs("div",{className:"mb-8 flex flex-wrap items-center gap-x-5 gap-y-2 border-b pb-6 text-sm text-gray-500",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"mr-1",children:"ðŸ‘¤"}),e.jsxs("span",{children:["By ",e.jsx("span",{className:"font-medium text-gray-700",children:((h=t.user)==null?void 0:h.name)??"Anonymous"})]})]}),t.created_at&&e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"mr-1",children:"ðŸ“…"}),e.jsx("span",{children:new Date(t.created_at).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})})]}),t.views!==void 0&&e.jsxs("div",{className:"flex items-center rounded-full bg-gray-100 px-3 py-1.5 text-gray-700",children:[e.jsx("span",{className:"mr-1",children:"ðŸ‘ï¸"}),e.jsxs("span",{children:[t.views.toLocaleString()," views"]})]}),t.likes!==void 0&&e.jsxs("div",{className:"flex items-center rounded-full bg-pink-100 px-3 py-1.5 text-pink-600",children:[e.jsx("span",{className:"mr-1",children:"â¤ï¸"}),e.jsxs("span",{children:[t.likes.toLocaleString()," likes"]})]})]}),e.jsx("div",{className:"prose prose-slate max-w-none",children:Array.isArray(t.content)&&t.content.sort((s,r)=>s.order-r.order).map((s,r)=>s.type==="text"?e.jsx("div",{dangerouslySetInnerHTML:{__html:s.content||""},className:"mb-6"},r):s.type==="image"&&s.image?e.jsx("div",{className:"mb-6",children:e.jsx("img",{src:`${s.image}`,alt:`Image Block ${r+1}`,className:"max-h-48 rounded-lg object-contain",style:{maxWidth:"50%"}})},r):null)}),e.jsxs("div",{className:"mt-10 flex justify-start gap-4 border-t pt-6",children:[e.jsxs(p,{href:`/admin/blogs/${t.id}/edit`,className:"inline-flex items-center gap-2 rounded-lg bg-blue-600 px-4 py-2 text-white transition-colors hover:bg-blue-700",children:[e.jsx(v,{size:18}),"Edit"]}),e.jsxs("button",{onClick:f,className:"inline-flex items-center gap-2 rounded-lg bg-red-600 px-4 py-2 text-white transition-colors hover:bg-red-700",children:[e.jsx(S,{size:18}),"Delete"]})]})]})]}),e.jsxs("div",{className:"mt-10",children:[e.jsx("h2",{className:"mb-4 text-xl font-semibold",children:"User Comments"}),e.jsx("div",{className:"overflow-x-auto rounded-lg border bg-white shadow",children:e.jsxs("table",{className:"min-w-full text-sm text-gray-700",children:[e.jsx("thead",{className:"bg-gray-50 text-left",children:e.jsxs("tr",{children:[e.jsx("th",{className:"border-b px-4 py-2",children:"Name"}),e.jsx("th",{className:"border-b px-4 py-2",children:"Email"}),e.jsx("th",{className:"border-b px-4 py-2",children:"Comment"}),e.jsx("th",{className:"border-b px-4 py-2",children:"Date"}),e.jsx("th",{className:"border-b px-4 py-2 text-center",children:"Actions"})]})}),e.jsx("tbody",{children:d.length>0?d.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"border-b px-4 py-2",children:s.name}),e.jsx("td",{className:"border-b px-4 py-2",children:s.email||"-"}),e.jsx("td",{className:"border-b px-4 py-2",children:s.comment}),e.jsx("td",{className:"border-b px-4 py-2",children:new Date(s.created_at).toLocaleString()}),e.jsx("td",{className:"border-b px-4 py-2 text-center",children:e.jsx("button",{onClick:()=>y(s.id),className:"inline-block rounded bg-red-500 px-3 py-1 text-white hover:bg-red-600",children:"Delete"})})]},s.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-4 py-6 text-center text-gray-500",children:"No comments yet."})})})]})})]})]})}):e.jsx("div",{className:"flex min-h-screen items-center justify-center",children:e.jsx("div",{className:"text-xl",children:"Blog not found."})})};export{E as default};
