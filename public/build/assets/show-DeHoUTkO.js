import{r,K as S,j as e,L as F,a as l}from"./app-eujjRd3E.js";import{F as L}from"./floatingquickaction-DR8sDUGK.js";import{N as B,F as $}from"./navbar-BPw_7O6Q.js";import{F as C,b as _,a as A}from"./index-CyUZ8-04.js";import D from"./related-DiegytDp.js";import"./map-pin-B2sp5ZO6.js";import"./createLucideIcon-DnzOwBgV.js";import"./move-right-BFeHW8mw.js";import"./Teknindo Awal-x7ZWJMXO.js";import"./x-uJJDSsTr.js";import"./chevron-right-BJ5OusJl.js";import"./user-UYF0KRAv.js";const Q=()=>{var f;const[s,i]=r.useState(null),[c,d]=r.useState([]),[N,x]=r.useState(!0),[h,p]=r.useState(null),{slug:n}=S().props,[g,u]=r.useState(null),w=async()=>{if(!n){p("No blog identifier found"),x(!1);return}try{const t=await l.get(`/api/blogs/${n}`),a=await l.get(`/api/blogs/${n}/comments`);i(t.data),d(Array.isArray(a.data)?a.data:a.data.comments??[]),console.log("Comments response:",a.data)}catch(t){console.error("Failed to load blog:",t),p("Failed to load blog details")}finally{x(!1)}},v=async t=>{try{const a=await l.post(`/api/blogs/${t}/like`);console.log("Liked:",a.data.likes)}catch(a){console.error("Like error:",a)}},k=async t=>{try{const a=await l.post(`/api/blogs/${t}/unlike`);console.log("Unliked:",a.data.likes)}catch(a){console.error("Unlike error:",a)}};return r.useEffect(()=>{w()},[n]),N?e.jsx("div",{className:"flex min-h-screen items-center justify-center bg-gray-50",children:e.jsx("div",{className:"animate-pulse text-xl text-gray-600",children:"Loading blog..."})}):h?e.jsx("div",{className:"flex min-h-screen items-center justify-center bg-red-50",children:e.jsx("div",{className:"text-xl text-red-700",children:h})}):s?e.jsxs(e.Fragment,{children:[e.jsx(F,{title:s.title}),e.jsx("div",{className:"mb-16",children:e.jsx(B,{})}),e.jsx("div",{className:"mx-auto flex hidden max-w-6xl justify-center md:flex",children:e.jsx("nav",{className:"mb-6 w-full pt-4 text-sm text-black",children:e.jsxs("ol",{className:"flex flex-wrap items-center space-x-2",children:[e.jsx("li",{children:e.jsx("a",{href:"/",className:"hover:underline",children:"Home"})}),e.jsx("li",{children:e.jsx("span",{className:"mx-1",children:"â€º"})}),e.jsx("li",{children:e.jsx("a",{href:"/blogs",className:"hover:underline",children:"Blogs"})}),e.jsx("li",{children:e.jsx("span",{className:"mx-1",children:"â€º"})}),e.jsx("li",{className:"max-w-xs truncate font-bold text-gray-800",title:s.title,children:s.title})]})})}),e.jsx("div",{className:"blog container mx-auto px-4 py-4",children:e.jsxs("div",{className:"mx-auto max-w-5xl",children:[s.thumbnail&&e.jsx("img",{src:s.thumbnail,alt:s.title,className:"mb-4 max-h-[72vh] w-full rounded-xl bg-gray-100 object-fill"}),e.jsx("article",{className:"overflow-hidden",children:e.jsxs("div",{className:"",children:[e.jsx("p",{className:"my-8 text-center text-4xl font-bold",children:s.title}),e.jsx("div",{className:"text-md mb-8 border-b pb-6",children:e.jsxs("div",{className:"flex flex-col gap-y-2 md:flex-row md:flex-wrap md:items-center md:justify-between md:gap-x-6 md:gap-y-4",children:[e.jsxs("div",{className:"flex flex-col gap-y-2 md:flex-row md:items-center md:gap-x-6",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"mr-1",children:"ðŸ‘¤"}),e.jsxs("span",{children:["By ",e.jsx("span",{className:"font-medium",children:((f=s.user)==null?void 0:f.name)??"Anonymous"})]})]}),s.created_at&&e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"mr-1",children:"ðŸ“…"}),e.jsx("span",{children:new Date(s.created_at).toLocaleDateString("en-GB",{day:"numeric",month:"long",year:"numeric"})})]})]}),e.jsxs("div",{className:"flex flex-col gap-y-2 md:flex-row md:items-center md:gap-x-4",children:[s.views!==void 0&&e.jsxs("div",{className:"md:bg-grey-100 flex items-center gap-x-2 rounded-full bg-pink-100 bg-transparent md:px-3 md:py-1.5",children:[e.jsx("span",{className:"mr-1",children:"ðŸ‘ï¸"}),e.jsxs("span",{children:[s.views.toLocaleString()," views"]})]}),s.likes!==void 0&&e.jsx("div",{className:"flex items-center gap-x-2 rounded-full bg-pink-100 bg-transparent text-pink-600 md:bg-pink-100 md:px-3 md:py-1.5",children:e.jsxs("button",{onClick:()=>{(s.likes??0)===0?(v(s.id),i({...s,likes:(s.likes??0)+1})):(k(s.id),i({...s,likes:Math.max((s.likes??1)-1,0)}))},className:"flex cursor-pointer items-center gap-2 rounded text-xs md:px-2 md:py-1","aria-label":s.likes&&s.likes>0?"Unlike":"Like",children:[s.likes&&s.likes>0?e.jsx("span",{className:"mr-2 text-pink-500 md:mr-1",children:"â¤ï¸"}):e.jsx("span",{className:"mr-2 text-pink-500 md:mr-1",children:"ðŸ¤"}),e.jsxs("span",{children:[s.likes.toLocaleString()," likes"]})]})}),e.jsxs("div",{className:"flex items-center gap-x-2",children:[e.jsx("p",{className:"text-semibold text-sm md:text-base",children:"Share"}),e.jsx("a",{href:`https://wa.me/?text=${encodeURIComponent(`${s.title} - ${window.location.href}`)}`,target:"_blank",rel:"noopener noreferrer",title:"Share on WhatsApp",className:"text-xl text-green-500 hover:text-green-600",children:e.jsx(C,{className:"h-6 w-6"})}),e.jsx("a",{href:`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(window.location.href)}`,target:"_blank",rel:"noopener noreferrer",title:"Share on Facebook",className:"text-xl text-blue-600 hover:text-blue-700",children:e.jsx(_,{className:"h-6 w-6"})}),e.jsx("a",{href:"https://www.instagram.com/",target:"_blank",rel:"noopener noreferrer",title:"Share on Instagram",className:"text-xl text-pink-500 hover:text-pink-600",children:e.jsx(A,{className:"h-6 w-6"})})]})]})]})}),e.jsx("div",{className:"prose prose-slate max-w-none",children:Array.isArray(s.content)&&s.content.sort((t,a)=>t.order-a.order).map((t,a)=>t.type==="text"?e.jsx("div",{dangerouslySetInnerHTML:{__html:t.content||""},className:"mb-6"},a):t.type==="image"&&t.image?e.jsx("div",{className:"mb-6",children:e.jsx("img",{src:t.image,alt:`Image Block ${a+1}`,className:"center mx-auto rounded-lg object-contain",style:{maxWidth:"50%"}})},a):null)})]})}),e.jsxs("div",{className:"mt-12",children:[e.jsx("h2",{className:"mb-4 text-2xl font-bold text-gray-800",children:"Leave a Comment"}),e.jsxs("form",{onSubmit:async t=>{t.preventDefault();const a=t.currentTarget,o=new FormData(a),j=o.get("name"),b=o.get("email"),y=o.get("comment");try{await l.post(`/api/blogs/${s.id}/comments`,{name:j,email:b,comment:y}),d(m=>[{id:Date.now(),name:j,email:b,comment:y,created_at:new Date().toISOString()},...m]),a.reset(),u("âœ… Your comment has been submitted."),setTimeout(()=>u(null),4e3)}catch(m){console.error("Failed to submit comment",m)}},className:"space-y-5 rounded-lg border border-gray-200 bg-white p-6 shadow-sm",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Name"}),e.jsx("input",{name:"name",required:!0,className:"mt-1 w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-yellow-500 focus:ring focus:ring-yellow-100"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),e.jsx("input",{type:"email",name:"email",required:!0,className:"mt-1 w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-yellow-500 focus:ring focus:ring-yellow-100"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Comment"}),e.jsx("textarea",{name:"comment",required:!0,rows:4,className:"mt-1 w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-yellow-500 focus:ring focus:ring-yellow-100"})]}),g&&e.jsx("div",{className:"rounded-md bg-green-50 px-4 py-3 text-sm text-green-800 ring-1 ring-green-300",children:g}),e.jsx("button",{type:"submit",className:"w-full rounded-md bg-yellow-500 px-4 py-2 font-semibold text-white transition hover:bg-yellow-600",children:"Submit"})]})]}),e.jsxs("div",{className:"mt-8",children:[e.jsx("h2",{className:"mb-4 text-2xl font-bold text-gray-800",children:"Comments"}),c.length===0?e.jsx("p",{className:"text-gray-500",children:"No comments yet."}):e.jsx("ul",{className:"space-y-4",children:c.map(t=>e.jsxs("li",{className:"flex items-start gap-4 rounded-lg border p-4 shadow-sm",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-yellow-100 font-bold text-yellow-700",children:t.name.charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-gray-800",children:t.name}),e.jsx("p",{className:"text-xs text-gray-400",children:new Date(t.created_at).toLocaleString("en-GB")}),e.jsx("p",{className:"mt-2 text-sm text-gray-700",children:t.comment})]})]},t.id))})]}),e.jsx(D,{blog:s})]})}),e.jsx(L,{}),e.jsx($,{})]}):e.jsx("div",{className:"flex min-h-screen items-center justify-center",children:e.jsx("div",{className:"text-xl",children:"Blog not found."})})};export{Q as default};
