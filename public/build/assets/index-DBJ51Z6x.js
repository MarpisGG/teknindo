import{K as C,U as o,j as r,$ as _,a as x}from"./app-eujjRd3E.js";import{A as $}from"./app-layout-CzrSvg4p.js";import{S as n}from"./sweetalert2.esm.all-BQIkj5Wb.js";import"./button-7djvlC_m.js";import"./utils-jAU0Cazi.js";import"./index-CTqnA2uk.js";import"./index-C1hkRcc-.js";import"./index-C8DxvRZU.js";import"./x-uJJDSsTr.js";import"./createLucideIcon-DnzOwBgV.js";import"./message-circle-Bh7x8iKR.js";import"./mail-BXazH--r.js";import"./map-pin-B2sp5ZO6.js";import"./star-BowgPiYH.js";import"./chevron-right-BJ5OusJl.js";const K=()=>{const{quotations:s,auth:k}=C().props,[p,h]=o.useState(""),[c,g]=o.useState(""),[d,b]=o.useState(""),f=e=>{n.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete it!"}).then(t=>{t.isConfirmed&&x.delete(`/admin/quotations/${e}`).then(()=>{n.fire("Deleted!","Your message has been deleted.","success"),window.location.reload()}).catch(a=>{n.fire("Error!",a.response.data.message,"error")})})},y=(e,t)=>{const[a,i]=o.useState(e);return o.useEffect(()=>{const l=setTimeout(()=>i(e),t);return()=>clearTimeout(l)},[e,t]),a},w=e=>{h(e.target.value.toLowerCase())},j=y(p,300),v=Array.from(new Set(s.data.map(e=>{var t;return(t=e.product)==null?void 0:t.name}).filter(Boolean))),N=Array.from(new Set(s.data.map(e=>{var t;return(t=e.service)==null?void 0:t.name}).filter(Boolean))),m=s.data.filter(e=>{var l,u;const t=(e.message||"").toLowerCase().includes(j),a=c?((l=e.product)==null?void 0:l.name)===c:!0,i=d?((u=e.service)==null?void 0:u.name)===d:!0;return t&&a&&i}),S=async e=>{try{await x.put(`/quotations/${e}/follow-up`),window.location.reload()}catch{n.fire("Error","Failed to update follow-up status","error")}};return r.jsx($,{children:r.jsxs("div",{className:"mx-auto max-w-6xl p-4 sm:p-6",children:[r.jsxs("div",{className:"mb-6 flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[r.jsx("h2",{className:"text-2xl font-bold text-gray-800 md:text-3xl",children:"Quotation"}),r.jsxs("div",{className:"flex w-full flex-col gap-2 sm:w-auto sm:flex-row sm:items-center",children:[r.jsx("input",{type:"text",onChange:w,placeholder:"Search quotation...",className:"w-full rounded-lg border border-black px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:outline-none sm:w-auto"}),r.jsxs("select",{value:c,onChange:e=>g(e.target.value),className:"rounded-lg border border-gray-400 px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:outline-none",children:[r.jsx("option",{value:"",children:"All Products"}),v.map(e=>r.jsx("option",{value:e,children:e},e))]}),r.jsxs("select",{value:d,onChange:e=>b(e.target.value),className:"rounded-lg border border-gray-400 px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:outline-none",children:[r.jsx("option",{value:"",children:"All Services"}),N.map(e=>r.jsx("option",{value:e,children:e},e))]}),r.jsx(_,{href:"/admin/dashboard",className:"rounded-lg border border-blue-600 px-4 py-2 text-center text-sm text-blue-600 hover:text-blue-800 sm:text-base",children:"← Back to Dashboard"})]})]}),r.jsx("div",{className:"overflow-x-auto rounded-lg border bg-white shadow",children:r.jsx("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-3",children:m.length>0?m.map(e=>{var t,a;return r.jsxs("div",{className:"rounded-lg border bg-white p-4 shadow",children:[r.jsx("h3",{className:"text-lg font-bold text-gray-800",children:e.name}),r.jsxs("p",{className:"text-sm text-gray-600",children:["Email: ",e.email]}),r.jsxs("p",{className:"text-sm text-gray-600",children:["Phone: ",e.phone]}),r.jsxs("p",{className:"text-sm text-gray-600",children:["Company: ",e.company]}),r.jsxs("p",{className:"text-sm text-gray-600",children:["Country: ",e.country]}),r.jsxs("p",{className:"text-sm text-gray-600",children:["Message: ",e.message]}),r.jsxs("p",{className:"text-sm text-gray-600",children:["Product: ",((t=e.product)==null?void 0:t.name)||"-"]}),r.jsxs("p",{className:"text-sm text-gray-600",children:["Service: ",((a=e.service)==null?void 0:a.name)||"-"]}),r.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[r.jsx("button",{onClick:()=>S(e.id),className:`rounded px-3 py-1 text-white ${e.followed_up?"bg-green-600":"bg-gray-400"}`,children:e.followed_up?"Done":"Mark as Done"}),r.jsx("button",{onClick:()=>f(e.id),className:"rounded bg-red-500 px-3 py-1 text-white hover:bg-red-600",children:"Delete"})]})]},e.id)}):r.jsx("div",{className:"col-span-full text-center text-gray-500",children:"No messages found."})})}),r.jsx("div",{className:"mt-6 flex justify-center",children:r.jsxs("nav",{className:"inline-flex items-center space-x-2",children:[s.current_page>1&&r.jsx("button",{onClick:()=>window.location.href=`?page=${s.current_page-1}`,className:"rounded border border-gray-300 bg-white px-4 py-2 text-gray-700 hover:bg-gray-100",children:"Previous"}),Array.from({length:s.last_page},(e,t)=>t+1).map(e=>r.jsx("button",{onClick:()=>window.location.href=`?page=${e}`,className:`rounded border px-4 py-2 ${e===s.current_page?"bg-blue-500 text-white":"border-gray-300 bg-white text-gray-700 hover:bg-gray-100"}`,children:e},e)),s.current_page<s.last_page&&r.jsx("button",{onClick:()=>window.location.href=`?page=${s.current_page+1}`,className:"rounded border border-gray-300 bg-white px-4 py-2 text-gray-700 hover:bg-gray-100",children:"Next"})]})})]})})};export{K as default};
