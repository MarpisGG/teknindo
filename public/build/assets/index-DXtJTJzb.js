import{K as w,U as l,j as e,$ as o,a as d}from"./app-eujjRd3E.js";import{A as N}from"./app-layout-CzrSvg4p.js";import{S as n}from"./sweetalert2.esm.all-BQIkj5Wb.js";import"./button-7djvlC_m.js";import"./utils-jAU0Cazi.js";import"./index-CTqnA2uk.js";import"./index-C1hkRcc-.js";import"./index-C8DxvRZU.js";import"./x-uJJDSsTr.js";import"./createLucideIcon-DnzOwBgV.js";import"./message-circle-Bh7x8iKR.js";import"./mail-BXazH--r.js";import"./map-pin-B2sp5ZO6.js";import"./star-BowgPiYH.js";import"./chevron-right-BJ5OusJl.js";const P=()=>{const{messages:r,auth:v}=w().props,[m,u]=l.useState(""),x=t=>{n.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete it!"}).then(a=>{a.isConfirmed&&d.delete(`/messages/${t}`).then(()=>{n.fire("Deleted!","Your message has been deleted.","success"),window.location.reload()}).catch(s=>{n.fire("Error!",s.response.data.message,"error")})})},p=(t,a)=>{const[s,y]=l.useState(t);return l.useEffect(()=>{const j=setTimeout(()=>y(t),a);return()=>clearTimeout(j)},[t,a]),s},h=t=>{u(t.target.value.toLowerCase())},g=p(m,300),[c,f]=l.useState("all"),i=r.data.filter(t=>{const a=t.message.toLowerCase().includes(g),s=c==="all"||t.category===c;return a&&s}),b=async t=>{try{await d.put(`/messages/${t}/follow-up`),window.location.reload()}catch{n.fire("Error","Failed to update follow-up status","error")}};return e.jsx(N,{children:e.jsxs("div",{className:"mx-auto max-w-6xl p-4 sm:p-6",children:[e.jsxs("div",{className:"mb-6 flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 md:text-3xl",children:"Messages"}),e.jsx("div",{className:"flex w-full flex-col gap-2 sm:w-auto sm:flex-row sm:items-center",children:e.jsxs("div",{className:"flex w-full flex-col gap-2 sm:w-auto sm:flex-row sm:items-center",children:[e.jsx("input",{type:"text",onChange:h,placeholder:"Search messages...",className:"w-full rounded-lg border border-black px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:outline-none sm:w-auto"}),e.jsxs("select",{value:c,onChange:t=>f(t.target.value),className:"rounded-lg border border-black px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:outline-none",children:[e.jsx("option",{value:"all",children:"All Categories"}),e.jsx("option",{value:"heavyequipment",children:"Heavy Equipment"}),e.jsx("option",{value:"sparepart",children:"Spare Part"}),e.jsx("option",{value:"other",children:"Other"})]}),e.jsx(o,{href:"/admin/dashboard",className:"rounded-lg border border-blue-600 px-4 py-2 text-center text-sm text-blue-600 hover:text-blue-800 sm:text-base",children:"← Back to Dashboard"})]})})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsx("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:i.length>0?i.map(t=>e.jsxs("div",{className:"rounded-lg border bg-white p-4 shadow-sm",children:[e.jsxs("h3",{className:"text-lg font-semibold",children:[t.first_name," ",t.last_name]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[t.email," | ",t.phone]}),e.jsxs("p",{className:"mt-2 text-sm",children:[e.jsx("span",{className:"font-semibold",children:"Company:"})," ",t.company]}),e.jsxs("p",{className:"text-sm",children:[e.jsx("span",{className:"font-semibold",children:"Country:"})," ",t.country]}),e.jsx("p",{className:"mt-2 text-sm text-gray-700",children:t.message}),e.jsxs("p",{className:"mt-1 text-xs text-gray-400 italic",children:["Category: ",t.category]}),e.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[e.jsx("button",{onClick:()=>b(t.id),className:`rounded px-3 py-1 text-sm text-white ${t.followed_up?"bg-green-600":"bg-gray-400"}`,children:t.followed_up?"Done":"Mark as Done"}),e.jsx("button",{onClick:()=>x(t.id),className:"rounded bg-red-500 px-3 py-1 text-sm text-white hover:bg-red-600",children:"Delete"})]})]},t.id)):e.jsx("p",{className:"col-span-full py-6 text-center text-gray-500",children:"No messages found."})})}),e.jsx("div",{className:"mt-6 flex justify-center",children:e.jsxs("nav",{className:"inline-flex items-center gap-1 rounded-lg bg-gray-50 px-3 py-2 shadow",children:[e.jsx(o,{href:`/admin/messages?page=${Math.max(1,r.current_page-1)}`,className:`rounded px-3 py-1 text-sm font-medium transition ${r.current_page===1?"pointer-events-none text-gray-400":"text-blue-600 hover:bg-blue-100"}`,"aria-disabled":r.current_page===1,children:"« Prev"}),Array.from({length:r.last_page},(t,a)=>{const s=a+1;return s===1||s===r.last_page||Math.abs(s-r.current_page)<=1?e.jsx(o,{href:`/admin/messages?page=${s}`,className:`rounded px-3 py-1 text-sm font-medium transition ${r.current_page===s?"bg-blue-600 text-white":"text-gray-700 hover:bg-blue-100"}`,children:s},s):s===r.current_page-2&&s>1||s===r.current_page+2&&s<r.last_page?e.jsx("span",{className:"px-2 text-gray-400",children:"..."},s):null}),e.jsx(o,{href:`/admin/messages?page=${Math.min(r.last_page,r.current_page+1)}`,className:`rounded px-3 py-1 text-sm font-medium transition ${r.current_page===r.last_page?"pointer-events-none text-gray-400":"text-blue-600 hover:bg-blue-100"}`,"aria-disabled":r.current_page===r.last_page,children:"Next »"})]})})]})})};export{P as default};
